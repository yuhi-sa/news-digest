"""Markdown formatter for paper digest PRs."""

from __future__ import annotations

from .paper_fetcher import Paper


def format_paper_pr_body(paper: Paper, summary: str, date_label: str) -> str:
    """Format the PR body for a paper digest."""
    authors_str = ", ".join(paper.authors[:5])
    if len(paper.authors) > 5:
        authors_str += f" ä»–{len(paper.authors) - 5}å"

    lines = [
        f"# ğŸ“„ Paper Digest: {date_label}",
        "",
        f"## {paper.title}",
        "",
        "| é …ç›® | è©³ç´° |",
        "|------|------|",
        f"| **è‘—è€…** | {authors_str} |",
        f"| **ç™ºè¡¨æ—¥** | {paper.published or 'ä¸æ˜'} |",
        f"| **åˆ†é‡** | {paper.category_ja} |",
        f"| **arXiv** | [ãƒªãƒ³ã‚¯]({paper.url}) |",
    ]

    if paper.pdf_url:
        lines.append(f"| **PDF** | [ãƒªãƒ³ã‚¯]({paper.pdf_url}) |")

    lines.extend([
        "",
        "---",
        "",
        summary,
        "",
        "---",
        f"Auto-generated by Paper Digest workflow. Category: {paper.category_ja}",
    ])

    return "\n".join(lines)
